@{
    ViewBag.Title = "Отчет по должникам";
    Layout = "layout_admin.cshtml";
}
@using credittrade.Modules
<link rel="stylesheet" href="~/Content/css/jquery.treegrid.css" />
<h2>@ViewBag.Title</h2>
<link rel="stylesheet" href="~/Content/css/jquery.treegrid.css" />
<style>
    .container {
        margin-left: 0;
    }

    table {
        width: 100%;
        border-collapse: collapse;
    }

    th, td {
        text-align: left;
        padding: 5px 10px;
        border-bottom: 1px solid #e5e5e5;
    }

    dt {
        color: #444;
        font-weight: 700;
    }

    th {
        color: #444;
    }

    img {
        max-width: 100%;
    }
</style>
<div>
    <select id="mon">
        <option id="6">Июнь 2017</option>
        <option id="7">Июль 2017</option>
        <option id="8">Август 2017</option>
        <option id="9">Сентябрь 2017</option>
        <option id="10">Октябрь 2017</option>
        <option id="11">Ноябрь 2017</option>
    </select>
</div>
<div class="dataTable_div col-md-10">
    <table id="buyers_table" class="row-border">
        <thead><tr><th>Подразделение</th><th>Сумма продаж</th><th>Сумма долга</th><th>Погашено</th><th>Просрочено</th></tr></thead>
        @{int p = 1;}
        @foreach (MrcReportRow reportRow in Model.reportRows)
        {
            int parent = p;
            <tr class="treegrid-@p">
                <td>
                    @reportRow.name
                </td>
                <td>
                    @reportRow.spent.ToString("C")
                </td>
                <td>
                    @reportRow.debt.ToString("C")
                </td>
                <td>
                    @reportRow.paid.ToString("C")
                </td>
                <td>
                    @reportRow.debtOverdue.ToString("C")
                </td>
            </tr>p++;
            foreach (var item in reportRow.children)
            {
                <tr class="treegrid-@p treegrid-parent-@parent">
                    <td>
                        @item.name
                    </td>
                    <td>
                        @item.spent.ToString("C")
                    </td>
                    <td>
                        @item.debt.ToString("C")
                    </td>
                    <td>
                        @item.paid.ToString("C")
                    </td>
                    <td>
                        @item.debtOverdue.ToString("C")
                    </td>
                </tr>p++;
            }
        }
    </table>
</div>

<script type="text/javascript" src="~/Content/scripts/jquery.treegrid.min.js"></script>

<script language="javascript">
    $(document).ready(function () {
        $("#buyers_table").treegrid({ "initialState": "collapsed" });
        $("#mon").change(function () {
            $(location).attr('href', '@Url.Content("~/admin/report_mrc/")' + $(this).find('option:selected').attr('id'));
        });
        $("select#mon").val("@Model.monStr");
    });
</script>

